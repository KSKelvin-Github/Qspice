ÿØÿÛ«symbol PLL-1ph-Enhanced
  «type: X»
  «description: Phase Lock Loop (Enhanced) - 1 Phase»
  «library file: |.subckt PLL-1ph-Enhanced u y y90 freq phi-wrap A yf\nB1 z 0 V=V(v)*V(ycos)\nB2 dw 0 V=Ki*idt(V(z),0)\nB3 w 0 V=V(dw)+w0\nB4 x 0 V=V(w)+V(zkp)\nB5 phi 0 V=idt(V(x),0)\nB6 ycos 0 V=cos(V(phi))\nB7 y 0 V=sin(V(phi))\nB8 freq 0 V=V(w)/2/pi\nB9 phi-d 0 V=V(phi)*180/pi\nB10 phi-wrap 0 V=( ( V(phi-d) - 180) % 360 ) - 180\nE1 zkp 0 z 0 Kp\nE2 y90 0 ycos 0 -1\nE3 e 0 u yf 1\nB11 v 0 V=V(e)/(abs(V(A))+epsilon*A0)\nB12 b 0 V=V(e)*V(y)\nB13 dA 0 V=Ka*idt(V(b),0)\nB14 A 0 V=V(dA)+A0\nB15 yf 0 V=V(A)*V(y)\nB16 Ki-factor 0 V=1/( 1 + lambda*V(e)/(abs(V(A))+epsilon*A0) )\n.param w0=2*pi*f0\n.param epsilon=0.001\n.param A0=1\n.param Ka=Kp\n.ends PLL-1ph-Enhanced»
  «shorted pins: false»
  «line (-850,0) (-750,0) 0 0 0x1000000 -1 -1»
  «line (-700,50) (-600,-50) 0 0 0x1000000 -1 -1»
  «line (-600,50) (-700,-50) 0 0 0x1000000 -1 -1»
  «line (-550,0) (-450,0) 0 0 0x1000000 -1 -1»
  «line (-270,50) (-280,-50) 0 0 0x1000000 -1 -1»
  «line (-400,-300) (-500,-300) 0 0 0x1000000 -1 -1»
  «line (-500,-300) (-500,0) 0 0 0x1000000 -1 -1»
  «line (-200,0) (-100,0) 0 0 0x1000000 -1 -1»
  «line (-75,0) (25,0) 0 0 0x1000000 -1 -1»
  «line (-25,50) (-25,-50) 0 0 0x1000000 -1 -1»
  «line (-25,175) (-25,75) 0 0 0x1000000 -1 -1»
  «line (200,0) (300,0) 0 0 0x1000000 -1 -1»
  «line (250,50) (250,-50) 0 0 0x1000000 -1 -1»
  «line (175,0) (45,0) 0 0 0x1000000 -1 -1»
  «line (-195,-300) (250,-300) 0 0 0x1000000 -1 -1»
  «line (250,-300) (250,-75) 0 0 0x1000000 -1 -1»
  «line (510,50) (500,-50) 0 0 0x1000000 -1 -1»
  «line (320,0) (400,0) 0 0 0x1000000 -1 -1»
  «line (600,0) (750,0) 0 0 0x1000000 -1 -1»
  «line (650,0) (650,300) 0 0 0x1000000 -1 -1»
  «line (650,300) (750,300) 0 0 0x1000000 -1 -1»
  «line (1100,0) (1000,0) 0 0 0x1000000 -1 -1»
  «line (1050,0) (1050,-500) 0 0 0x1000000 -1 -1»
  «line (1050,-500) (-650,-500) 0 0 0x1000000 -1 -1»
  «line (-650,-500) (-650,-100) 0 0 0x1000000 -1 -1»
  «line (1600,300) (1000,300) 0 0 0x1000000 -1 -1»
  «line (1600,0) (1300,0) 0 0 0x1000000 -1 -1»
  «line (1600,-800) (100,-800) 0 1 0x1000000 -1 -1»
  «line (100,-800) (100,0) 0 1 0x1000000 -1 -1»
  «line (1600,-600) (650,-600) 0 1 0x1000000 -1 -1»
  «line (650,-600) (650,0) 0 1 0x1000000 -1 -1»
  «line (-1000,0) (-900,0) 0 0 0x1000000 -1 -1»
  «line (-950,-300) (-950,-100) 0 0 0x1000000 -1 -1»
  «line (-1150,0) (-1050,0) 0 0 0x1000000 -1 -1»
  «line (-1300,0) (-1500,0) 0 0 0x1000000 -1 -1»
  «line (-1370,-60) (-1300,-60) 0 0 0x1000000 -1 -1»
  «line (-1335,-95) (-1335,-25) 0 0 0x1000000 -1 -1»
  «line (-1330,110) (-1260,110) 0 0 0x1000000 -1 -1»
  «line (-800,600) (-750,600) 0 0 0x1000000 -1 -1»
  «line (-700,650) (-600,550) 0 0 0x1000000 -1 -1»
  «line (-600,650) (-700,550) 0 0 0x1000000 -1 -1»
  «line (-550,600) (-450,600) 0 0 0x1000000 -1 -1»
  «line (-800,0) (-800,600) 0 0 0x1000000 -1 -1»
  «line (-270,650) (-280,550) 0 0 0x1000000 -1 -1»
  «line (-200,600) (-100,600) 0 0 0x1000000 -1 -1»
  «line (-75,600) (25,600) 0 0 0x1000000 -1 -1»
  «line (-25,650) (-25,550) 0 0 0x1000000 -1 -1»
  «line (-25,775) (-25,675) 0 0 0x1000000 -1 -1»
  «line (50,600) (200,600) 0 0 0x1000000 -1 -1»
  «line (250,650) (350,550) 0 0 0x1000000 -1 -1»
  «line (350,650) (250,550) 0 0 0x1000000 -1 -1»
  «line (400,600) (1600,600) 0 0 0x1000000 -1 -1»
  «line (1400,300) (1400,450) 0 0 0x1000000 -1 -1»
  «line (1400,450) (-650,450) 0 0 0x1000000 -1 -1»
  «line (-650,450) (-650,500) 0 0 0x1000000 -1 -1»
  «line (300,450) (300,500) 0 0 0x1000000 -1 -1»
  «line (100,750) (100,600) 0 1 0x1000000 -1 -1»
  «line (100,750) (500,750) 0 1 0x1000000 -1 -1»
  «line (450,800) (500,750) 0 0 0x1000000 -1 -1»
  «line (500,750) (450,700) 0 0 0x1000000 -1 -1»
  «line (1600,-1000) (1350,-1000) 0 1 0x1000000 -1 -1»
  «line (1400,600) (1400,950) 0 0 0x1000000 -1 -1»
  «line (1400,950) (-1225,955) 0 0 0x1000000 -1 -1»
  «line (-1225,955) (-1225,75) 0 0 0x1000000 -1 -1»
  «line (1300,-950) (1350,-1000) 0 0 0x1000000 -1 -1»
  «line (1350,-1000) (1300,-1050) 0 0 0x1000000 -1 -1»
  «rect (-1500,1100) (1600,-1100) 0 0 0 0x1000000 0xffe6c8 -1 0 -1»
  «rect (-750,100) (-550,-100) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «rect (-450,100) (-200,-100) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «rect (-200,-200) (-400,-400) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «rect (600,100) (400,-100) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «rect (750,100) (1000,-100) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «rect (750,400) (1000,200) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «rect (1100,100) (1300,-100) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «rect (-1050,100) (-850,-100) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «rect (-750,700) (-550,500) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «rect (-450,700) (-200,500) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «rect (200,700) (400,500) 0 0 0 0x1000000 0x1000000 -1 0 -1»
  «ellipse (-210,50) (-250,80) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (-300,-80) (-340,-50) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (-100,75) (50,-75) 0 0 0 0x1000000 0x1000000 -1 -1»
  «ellipse (175,75) (325,-75) 0 0 0 0x1000000 0x1000000 -1 -1»
  «ellipse (570,50) (530,80) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (480,-80) (440,-50) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (1025,25) (1075,-25) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (-525,25) (-475,-25) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (75,25) (125,-25) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (625,25) (675,-25) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (-965,60) (-935,30) 0 0 0 0x1000000 0x1000000 -1 -1»
  «ellipse (-965,-30) (-935,-60) 0 0 0 0x1000000 0x1000000 -1 -1»
  «ellipse (-1300,75) (-1150,-75) 0 0 0 0x1000000 0x1000000 -1 -1»
  «ellipse (-210,650) (-250,680) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (-300,520) (-340,550) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (-100,675) (50,525) 0 0 0 0x1000000 0x1000000 -1 -1»
  «ellipse (1375,325) (1425,275) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (275,475) (325,425) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (-825,25) (-775,-25) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (75,625) (125,575) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (1375,625) (1425,575) 0 0 0 0x1000000 0xff0012 -1 -1»
  «ellipse (-1040,25) (-1020,5) 0 0 0 0x1000000 0x1000000 -1 -1»
  «arc3p (-220,80) (-270,50) (-240,30) 0 0 0x1000000 -1 -1»
  «arc3p (-330,-80) (-280,-50) (-310,-30) 0 0 0x1000000 -1 -1»
  «arc3p (560,80) (510,50) (540,30) 0 0 0x1000000 -1 -1»
  «arc3p (450,-80) (500,-50) (470,-30) 0 0 0x1000000 -1 -1»
  «arc3p (-220,680) (-270,650) (-240,630) 0 0 0x1000000 -1 -1»
  «arc3p (-330,520) (-280,550) (-310,570) 0 0 0x1000000 -1 -1»
  «text (-1500,1350) 1 7 0 0x1000000 -1 -1 "X1"»
  «text (-1500,1200) 1 7 0 0x1000000 -1 -1 "PLL-1PH-ENHANCED"»
  «text (-1500,-1350) 1 7 0 0x0 -1 -1 "w0=<2*pi*f0> ;Rated frequency in omega"»
  «text (-1500,-1500) 1 7 0 0x0 -1 -1 "zeta1=<float[0.25:0.75](0.5)> ;zeta1"»
  «text (-1500,-1650) 1 7 0 0x0 -1 -1 "zeta2=<float[1:2](1)> ;zeta2"»
  «text (-1500,-1800) 1 7 0 0x0 -1 -1 "Kp=<2*zeta1*w0> ;Proportional Gain Kp"»
  «text (-1500,-1950) 1 7 0 0x0 -1 -1 "Ki=<Kp^2/(8*zeta2^2)> ;Integral Gain Ki"»
  «text (-1500,-2100) 1 7 0 0x0 -1 -1 "Lambda=<float[0:20](10)> ;Coefficient lambda"»
  «text (-1500,-2250) 1 7 0 0x0 -1 -1 "f0=<f0> ;Rated frequency of the input signal"»
  «text (-380,10) 0.857 0 1 0x1000000 -1 -1 "Ki"»
  «text (-300,-290) 0.857 0 1 0x1000000 -1 -1 "Kp"»
  «text (-30,250) 0.857 0 1 0x1000000 -1 -1 "w0"»
  «text (870,10) 0.857 0 1 0x1000000 -1 -1 "cos"»
  «text (870,310) 0.857 0 1 0x1000000 -1 -1 "sin"»
  «text (1190,10) 0.857 0 1 0x1000000 -1 -1 "-1"»
  «text (-1488,-1200) 1 7 1 0x1000000 -1 -1 "Parameters optimized, only input freqeuncy f0"»
  «text (-950,-350) 0.857 0 1 0x1000000 -1 -1 "|A|+¢A0"»
  «text (-370,610) 0.794 0 1 0x1000000 -1 -1 "Ka"»
  «text (-30,850) 0.857 0 1 0x1000000 -1 -1 "A0"»
  «text (570,750) 0.857 0 1 0x1000000 -1 -1 "A"»
  «text (1250,-1000) 0.857 0 1 0x1000000 -1 -1 "A"»
  «pin (-1500,0) (20,0) 1 6 0 0x0 -1 "u"»
  «pin (1600,300) (-20,0) 1 10 0 0x0 -1 "y"»
  «pin (1600,0) (-20,0) 1 10 0 0x0 -1 "y90"»
  «pin (1600,-800) (-20,10) 1 10 0 0x0 -1 "freq"»
  «pin (1600,-600) (-20,0) 1 10 0 0x0 -1 "phi"»
  «pin (1600,-1000) (-20,0) 1 10 0 0x0 -1 "A"»
  «pin (1600,600) (-20,0) 1 10 0 0x0 -1 "yf"»
»
